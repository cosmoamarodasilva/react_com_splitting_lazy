{"ast":null,"code":"'use strict';\n\nconst process = require('process');\n\nconst mysql = require('../index.js');\n\nconst EventEmitter = require('events').EventEmitter;\n\nconst PoolConnection = require('./pool_connection.js');\n\nconst Queue = require('denque');\n\nconst Connection = require('./connection.js');\n\nfunction spliceConnection(queue, connection) {\n  const len = queue.length;\n\n  for (let i = 0; i < len; i++) {\n    if (queue.get(i) === connection) {\n      queue.removeOne(i);\n      break;\n    }\n  }\n}\n\nclass Pool extends EventEmitter {\n  constructor(options) {\n    super();\n    this.config = options.config;\n    this.config.connectionConfig.pool = this;\n    this._allConnections = new Queue();\n    this._freeConnections = new Queue();\n    this._connectionQueue = new Queue();\n    this._closed = false;\n  }\n\n  promise(promiseImpl) {\n    const PromisePool = require('../promise').PromisePool;\n\n    return new PromisePool(this, promiseImpl);\n  }\n\n  getConnection(cb) {\n    if (this._closed) {\n      return process.nextTick(() => cb(new Error('Pool is closed.')));\n    }\n\n    let connection;\n\n    if (this._freeConnections.length > 0) {\n      connection = this._freeConnections.shift();\n      this.emit('acquire', connection);\n      return process.nextTick(() => cb(null, connection));\n    }\n\n    if (this.config.connectionLimit === 0 || this._allConnections.length < this.config.connectionLimit) {\n      connection = new PoolConnection(this, {\n        config: this.config.connectionConfig\n      });\n\n      this._allConnections.push(connection);\n\n      return connection.connect(err => {\n        if (this._closed) {\n          return cb(new Error('Pool is closed.'));\n        }\n\n        if (err) {\n          return cb(err);\n        }\n\n        this.emit('connection', connection);\n        this.emit('acquire', connection);\n        return cb(null, connection);\n      });\n    }\n\n    if (!this.config.waitForConnections) {\n      return process.nextTick(() => cb(new Error('No connections available.')));\n    }\n\n    if (this.config.queueLimit && this._connectionQueue.length >= this.config.queueLimit) {\n      return cb(new Error('Queue limit reached.'));\n    }\n\n    this.emit('enqueue');\n    return this._connectionQueue.push(cb);\n  }\n\n  releaseConnection(connection) {\n    let cb;\n\n    if (!connection._pool) {\n      // The connection has been removed from the pool and is no longer good.\n      if (this._connectionQueue.length) {\n        cb = this._connectionQueue.shift();\n        process.nextTick(this.getConnection.bind(this, cb));\n      }\n    } else if (this._connectionQueue.length) {\n      cb = this._connectionQueue.shift();\n      process.nextTick(cb.bind(null, null, connection));\n    } else {\n      this._freeConnections.push(connection);\n\n      this.emit('release', connection);\n    }\n  }\n\n  end(cb) {\n    this._closed = true;\n\n    if (typeof cb !== 'function') {\n      cb = function (err) {\n        if (err) {\n          throw err;\n        }\n      };\n    }\n\n    let calledBack = false;\n    let closedConnections = 0;\n    let connection;\n\n    const endCB = function (err) {\n      if (calledBack) {\n        return;\n      }\n\n      if (err || ++closedConnections >= this._allConnections.length) {\n        calledBack = true;\n        cb(err);\n        return;\n      }\n    }.bind(this);\n\n    if (this._allConnections.length === 0) {\n      endCB();\n      return;\n    }\n\n    for (let i = 0; i < this._allConnections.length; i++) {\n      connection = this._allConnections.get(i);\n\n      connection._realEnd(endCB);\n    }\n  }\n\n  query(sql, values, cb) {\n    const cmdQuery = Connection.createQuery(sql, values, cb, this.config.connectionConfig);\n\n    if (typeof cmdQuery.namedPlaceholders === 'undefined') {\n      cmdQuery.namedPlaceholders = this.config.connectionConfig.namedPlaceholders;\n    }\n\n    this.getConnection((err, conn) => {\n      if (err) {\n        if (typeof cmdQuery.onResult === 'function') {\n          cmdQuery.onResult(err);\n        } else {\n          cmdQuery.emit('error', err);\n        }\n\n        return;\n      }\n\n      try {\n        conn.query(cmdQuery).once('end', () => {\n          conn.release();\n        });\n      } catch (e) {\n        conn.release();\n        throw e;\n      }\n    });\n    return cmdQuery;\n  }\n\n  execute(sql, values, cb) {\n    // TODO construct execute command first here and pass it to connection.execute\n    // so that polymorphic arguments logic is there in one place\n    if (typeof values === 'function') {\n      cb = values;\n      values = [];\n    }\n\n    this.getConnection((err, conn) => {\n      if (err) {\n        return cb(err);\n      }\n\n      try {\n        conn.execute(sql, values, cb).once('end', () => {\n          conn.release();\n        });\n      } catch (e) {\n        conn.release();\n        throw e;\n      }\n    });\n  }\n\n  _removeConnection(connection) {\n    // Remove connection from all connections\n    spliceConnection(this._allConnections, connection); // Remove connection from free connections\n\n    spliceConnection(this._freeConnections, connection);\n    this.releaseConnection(connection);\n  }\n\n  format(sql, values) {\n    return mysql.format(sql, values, this.config.connectionConfig.stringifyObjects, this.config.connectionConfig.timezone);\n  }\n\n  escape(value) {\n    return mysql.escape(value, this.config.connectionConfig.stringifyObjects, this.config.connectionConfig.timezone);\n  }\n\n  escapeId(value) {\n    return mysql.escapeId(value, false);\n  }\n\n}\n\nmodule.exports = Pool;","map":{"version":3,"sources":["C:/Users/anafe/OneDrive/Documentos/projeto_com_react2/src/backend/node/node_modules/mysql2/lib/pool.js"],"names":["process","require","mysql","EventEmitter","PoolConnection","Queue","Connection","spliceConnection","queue","connection","len","length","i","get","removeOne","Pool","constructor","options","config","connectionConfig","pool","_allConnections","_freeConnections","_connectionQueue","_closed","promise","promiseImpl","PromisePool","getConnection","cb","nextTick","Error","shift","emit","connectionLimit","push","connect","err","waitForConnections","queueLimit","releaseConnection","_pool","bind","end","calledBack","closedConnections","endCB","_realEnd","query","sql","values","cmdQuery","createQuery","namedPlaceholders","conn","onResult","once","release","e","execute","_removeConnection","format","stringifyObjects","timezone","escape","value","escapeId","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nconst process = require('process');\nconst mysql = require('../index.js');\n\nconst EventEmitter = require('events').EventEmitter;\nconst PoolConnection = require('./pool_connection.js');\nconst Queue = require('denque');\nconst Connection = require('./connection.js');\n\nfunction spliceConnection(queue, connection) {\n  const len = queue.length;\n  for (let i = 0; i < len; i++) {\n    if (queue.get(i) === connection) {\n      queue.removeOne(i);\n      break;\n    }\n  }\n}\n\nclass Pool extends EventEmitter {\n  constructor(options) {\n    super();\n    this.config = options.config;\n    this.config.connectionConfig.pool = this;\n    this._allConnections = new Queue();\n    this._freeConnections = new Queue();\n    this._connectionQueue = new Queue();\n    this._closed = false;\n  }\n\n  promise(promiseImpl) {\n    const PromisePool = require('../promise').PromisePool;\n    return new PromisePool(this, promiseImpl);\n  }\n\n  getConnection(cb) {\n    if (this._closed) {\n      return process.nextTick(() => cb(new Error('Pool is closed.')));\n    }\n    let connection;\n    if (this._freeConnections.length > 0) {\n      connection = this._freeConnections.shift();\n      this.emit('acquire', connection);\n      return process.nextTick(() => cb(null, connection));\n    }\n    if (\n      this.config.connectionLimit === 0 ||\n      this._allConnections.length < this.config.connectionLimit\n    ) {\n      connection = new PoolConnection(this, {\n        config: this.config.connectionConfig\n      });\n      this._allConnections.push(connection);\n      return connection.connect(err => {\n        if (this._closed) {\n          return cb(new Error('Pool is closed.'));\n        }\n        if (err) {\n          return cb(err);\n        }\n        this.emit('connection', connection);\n        this.emit('acquire', connection);\n        return cb(null, connection);\n      });\n    }\n    if (!this.config.waitForConnections) {\n      return process.nextTick(() => cb(new Error('No connections available.')));\n    }\n    if (\n      this.config.queueLimit &&\n      this._connectionQueue.length >= this.config.queueLimit\n    ) {\n      return cb(new Error('Queue limit reached.'));\n    }\n    this.emit('enqueue');\n    return this._connectionQueue.push(cb);\n  }\n\n  releaseConnection(connection) {\n    let cb;\n    if (!connection._pool) {\n      // The connection has been removed from the pool and is no longer good.\n      if (this._connectionQueue.length) {\n        cb = this._connectionQueue.shift();\n        process.nextTick(this.getConnection.bind(this, cb));\n      }\n    } else if (this._connectionQueue.length) {\n      cb = this._connectionQueue.shift();\n      process.nextTick(cb.bind(null, null, connection));\n    } else {\n      this._freeConnections.push(connection);\n      this.emit('release', connection);\n    }\n  }\n\n  end(cb) {\n    this._closed = true;\n    if (typeof cb !== 'function') {\n      cb = function(err) {\n        if (err) {\n          throw err;\n        }\n      };\n    }\n    let calledBack = false;\n    let closedConnections = 0;\n    let connection;\n    const endCB = function(err) {\n      if (calledBack) {\n        return;\n      }\n      if (err || ++closedConnections >= this._allConnections.length) {\n        calledBack = true;\n        cb(err);\n        return;\n      }\n    }.bind(this);\n    if (this._allConnections.length === 0) {\n      endCB();\n      return;\n    }\n    for (let i = 0; i < this._allConnections.length; i++) {\n      connection = this._allConnections.get(i);\n      connection._realEnd(endCB);\n    }\n  }\n\n  query(sql, values, cb) {\n    const cmdQuery = Connection.createQuery(\n      sql,\n      values,\n      cb,\n      this.config.connectionConfig\n    );\n    if (typeof cmdQuery.namedPlaceholders === 'undefined') {\n      cmdQuery.namedPlaceholders = this.config.connectionConfig.namedPlaceholders;\n    }\n    this.getConnection((err, conn) => {\n      if (err) {\n        if (typeof cmdQuery.onResult === 'function') {\n          cmdQuery.onResult(err);\n        } else {\n          cmdQuery.emit('error', err);\n        }\n        return;\n      }\n      try {\n        conn.query(cmdQuery).once('end', () => {\n          conn.release();\n        });\n      } catch (e) {\n        conn.release();\n        throw e;\n      }\n    });\n    return cmdQuery;\n  }\n\n  execute(sql, values, cb) {\n    // TODO construct execute command first here and pass it to connection.execute\n    // so that polymorphic arguments logic is there in one place\n    if (typeof values === 'function') {\n      cb = values;\n      values = [];\n    }\n    this.getConnection((err, conn) => {\n      if (err) {\n        return cb(err);\n      }\n      try {\n        conn.execute(sql, values, cb).once('end', () => {\n          conn.release();\n        });\n      } catch (e) {\n        conn.release();\n        throw e;\n      }\n    });\n  }\n\n  _removeConnection(connection) {\n    // Remove connection from all connections\n    spliceConnection(this._allConnections, connection);\n    // Remove connection from free connections\n    spliceConnection(this._freeConnections, connection);\n    this.releaseConnection(connection);\n  }\n\n  format(sql, values) {\n    return mysql.format(\n      sql,\n      values,\n      this.config.connectionConfig.stringifyObjects,\n      this.config.connectionConfig.timezone\n    );\n  }\n\n  escape(value) {\n    return mysql.escape(\n      value,\n      this.config.connectionConfig.stringifyObjects,\n      this.config.connectionConfig.timezone\n    );\n  }\n\n  escapeId(value) {\n    return mysql.escapeId(value, false);\n  }\n}\n\nmodule.exports = Pool;\n"]},"metadata":{},"sourceType":"module"}