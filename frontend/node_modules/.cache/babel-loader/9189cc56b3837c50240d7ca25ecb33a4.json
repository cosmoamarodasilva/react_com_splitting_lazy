{"ast":null,"code":"const express = require('express');\n\nconst bodyParser = require('body-parser');\n\nconst mysql = require('mysql2');\n\nconst ejs = require('ejs');\n\nconst cors = require('cors');\n\nconst app = express();\nlet conexao = mysql.createConnection({\n  host: 'localhost',\n  user: 'root',\n  database: 'cosmoeletro'\n});\nconexao.connect(error => {\n  if (error) {\n    console.log('falhou bicho burro' + error);\n  } else {\n    console.log('sucesso');\n  }\n});\nlet sql = 'SELECT * FROM produtos';\nconexao.query(sql, (error, resultado) => {\n  console.log(resultado);\n});\nconst porta = 8080;\napp.set('view engine', 'ejs');\napp.use(bodyParser.json());\napp.use(cors());\napp.use((requisitar, resposta, next) => {\n  resposta.header('Access-Control-Allow-Origin', '*');\n  next();\n});\napp.get('/produtos', (requisitar, resposta) => {\n  conexao.query(sql, (error, resultado) => {\n    resposta.send(resultado);\n  });\n});\napp.post('/mensagens', (requisitar, resposta) => {\n  let post = requisitar.body;\n  let nome = post.nome;\n  let email = post.email;\n  let mensagem = post.mensagem;\n  let comando = `INSERT INTO clientes(nome_cliente, email) VALUES ('${nome}', '${email}');`;\n  let comando2 = `SELECT id_cliente FROM clientes WHERE email = '${email}' ORDER BY id_cliente DESC LIMIT 1;`;\n  conexao.query(comando);\n  conexao.query(comando2, (erro, id_final) => {\n    console.log(id_final[0].id_cliente);\n    let comando3 = `INSERT INTO mensagens (id_cliente,mensagem) VALUES ('${id_final[0].id_cliente}','${mensagem}');`;\n    conexao.query(comando3);\n  });\n});\napp.get('/pegar_mensagens', (requisitar, resposta) => {\n  let comando = \"SELECT nome_cliente, mensagem FROM mensagens JOIN clientes ON clientes.id_cliente = mensagens.id_cliente LIMIT 5;\";\n  conexao.query(comando, (erro, resultado) => {\n    resposta.send(resultado);\n  });\n});\napp.listen(porta);","map":{"version":3,"sources":["C:/Users/anafe/OneDrive/Documentos/projeto_com_react2/src/backend/node/conexao.js"],"names":["express","require","bodyParser","mysql","ejs","cors","app","conexao","createConnection","host","user","database","connect","error","console","log","sql","query","resultado","porta","set","use","json","requisitar","resposta","next","header","get","send","post","body","nome","email","mensagem","comando","comando2","erro","id_final","id_cliente","comando3","listen"],"mappings":"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","sourcesContent":["const express    = require('express');\r\nconst bodyParser = require('body-parser');\r\nconst mysql      = require('mysql2');\r\nconst ejs        = require('ejs');\r\nconst cors       = require('cors');\r\n\r\nconst app = express();\r\n\r\nlet conexao = mysql.createConnection({\r\n\r\n    host: 'localhost',\r\n    user: 'root',\r\n    database: 'cosmoeletro'\r\n});\r\n\r\n\r\nconexao.connect((error) =>{\r\n    if (error){\r\n        console.log('falhou bicho burro' + error);\r\n    }\r\n\r\n    else{\r\n        console.log('sucesso');\r\n    }\r\n});\r\n\r\nlet sql = 'SELECT * FROM produtos';\r\nconexao.query(sql, (error, resultado) =>{\r\n    console.log(resultado);\r\n});\r\n\r\nconst porta = 8080;\r\n\r\napp.set('view engine', 'ejs');\r\napp.use(bodyParser.json());\r\napp.use(cors());\r\napp.use((requisitar, resposta, next) =>{\r\n    resposta.header('Access-Control-Allow-Origin', '*');\r\n    next();\r\n})\r\n\r\napp.get('/produtos', (requisitar, resposta) => {\r\n\r\n    conexao.query(sql,(error, resultado) =>{ \r\n        resposta.send(resultado);\r\n    });\r\n\r\n});\r\n\r\napp.post('/mensagens', (requisitar, resposta) => {\r\n\r\n    let post = requisitar.body;\r\n\r\n    let nome = post.nome;\r\n    let email = post.email;\r\n    let mensagem = post.mensagem;\r\n\r\n    let comando = `INSERT INTO clientes(nome_cliente, email) VALUES ('${nome}', '${email}');`\r\n    let comando2 = `SELECT id_cliente FROM clientes WHERE email = '${email}' ORDER BY id_cliente DESC LIMIT 1;`\r\n    \r\n    conexao.query(comando)\r\n    conexao.query(comando2,(erro, id_final) =>{\r\n        console.log(id_final[0].id_cliente);\r\n        let comando3 = `INSERT INTO mensagens (id_cliente,mensagem) VALUES ('${id_final[0].id_cliente}','${mensagem}');`\r\n    conexao.query(comando3);\r\n    })\r\n   \r\n    });\r\n\r\napp.get('/pegar_mensagens', (requisitar, resposta) =>{\r\n    let comando = \"SELECT nome_cliente, mensagem FROM mensagens JOIN clientes ON clientes.id_cliente = mensagens.id_cliente LIMIT 5;\";\r\n    conexao.query(comando,(erro,resultado) =>{\r\n        resposta.send(resultado);\r\n    })\r\n});\r\n\r\napp.listen(porta);\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}